{%extends '/layout.html'%}
{% set is_admin = session['user_role'] == 'admin' %}
{%block title%}Movimientos de masas{%endblock%}
{%block body%}    
    <h3>Movimientos de masas</h1>
    {% if not is_admin %}
        <a href="{{ url_for('.create') }}" class="button">Nuevo movimiento</a>
    {% endif %}
    
    {% if movimientos %}
        <table>
            <thead>
                <tr>
                    <th></th>
                    <th>Id</th>
                    <th>Encuestador</th>
                    <th>Fecha</th>
                    <th>Institución</th>
                    <th>Código</th>
                    <th>Usuario registra</th>
                </tr>
            </thead>
            <tbody>
                {% for mov in movimientos %}
                    <tr>
                        <td>
                            <ul class="dropdown menu" data-dropdown-menu>
                                <li>
                                    <a href="#">Opciones</a>
                                    <ul class="menu">
                                        {% if not is_admin %}
                                            <li><a href="{{ url_for('.edit', id=mov.id)}}">Editar</a></li>
                                            <li><a href="{{ url_for('.delete', id=mov.id)}}" class="delete-confirm">Eliminar</a></li>
                                        {% endif %}
                                        <li><a href="{{ url_for('.view', id=mov.id) }}">Imprimir</a></li>
                                        <li><a href="{{ url_for('.download', id=mov.id) }}">Descargar</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </td>
                        <td>{{ mov.id }}</td>
                        <td>{{ mov.encuestador }}</td>
                        <td>{{ mov.fecha }}</td>
                        <td>{{ mov.institucion }}</td>
                        <td>{{ mov.codigo }}</td>
                        <td>{{ mov.usuario.name }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <h5 class="margin-top-3 text-center">Aún no se han creado movimientos</h3>
    {% endif %}
                
{%endblock%}